# Ergo - 产品需求文档 (PRD)

> 版本: v3.0 | 更新: 2026-02-15
>
> 本文档聚焦用户需求，不涉及技术实现方案。

---

## 一、背景与问题

### 用户是谁

terryzin，个人开发者，在本地机器上搭建了 OpenClaw AI 平台，并通过 cpolar 内网穿透对外暴露服务。

### 核心痛点

**痛点 1：OpenClaw 系统不稳定，远程运维困难**

OpenClaw 系统经常出现各种问题——服务崩溃、任务执行异常、配置需要调整。每次出问题都需要远程桌面连到部署机器上操作，非常不方便。特别是在外面只有手机的时候，几乎无法处理。

> "系统挂了，我在外面只能干瞪眼，等回家再处理。"

**痛点 2：开发工作缺少远程监控**

除了 OpenClaw 运维，还有用 Claude Code 做项目研发的需求。开发过程中起的服务、运行的任务，离开电脑后就看不到了。希望在手机上也能看到开发中的服务状态、预览页面。

> "用 Claude Code 开发了一个页面，想在手机上看看效果，但还得专门配置。"

### 核心诉求总结

| # | 诉求 | 优先级 |
|---|------|--------|
| 1 | 随时随地监控 OpenClaw 系统运行状态 | 最高 |
| 2 | 系统崩溃时能远程重启恢复 | 最高 |
| 3 | 远程查看和修改 OpenClaw 配置 | 高 |
| 4 | 监控开发中的服务和任务 | 高 |
| 5 | 手机端浏览开发中的页面和服务 | 中 |

---

## 二、产品定义

### 产品定位

Ergo（二狗）是一个**个人远程运维控制台**，让用户在手机或任何外部网络环境下，能够监控、管理和恢复本地部署的 AI 系统和开发服务。

### 核心价值

```
看得到 → 管得了 → 修得好
```

- **看得到**: 一眼掌握所有服务的健康状态
- **管得了**: 常用运维操作在手机上就能完成
- **修得好**: 系统出问题时有能力远程诊断和恢复

### 产品边界

**做**:
- OpenClaw 系统的状态监控、配置管理、故障恢复
- 开发服务的状态监控和访问入口
- 以上所有功能在手机端可用

**不做**:
- 不替代 OpenClaw Dashboard 的全部管理能力（复杂的 Agent 编排、工作流设计等留给 Dashboard）
- 不替代 Claude Code 本身（代码编辑、项目管理留在桌面端）

### 设计原则

1. **手机优先**: 主要使用场景是手机端，所有设计以手机体验为基准
2. **一眼可知**: 打开页面不需要任何操作就能看到关键状态
3. **诚实反馈**: 不伪造状态，拿不到数据就说"未知"，出了错就告诉用户
4. **渐进披露**: 默认展示概要，按需展开细节，避免信息过载
5. **可扩展**: 功能以模块化方式组织，未来新增功能不影响已有结构

---

## 三、用户场景

### 场景域 A：OpenClaw 运维

#### A1. 日常巡检 — "瞄一眼"

**频率**: 每天多次

**故事**: 早上出门前、午休时、晚上睡觉前，打开手机看一眼，确认系统正常运转。

**用户期望**:
- 打开页面，2 秒内看到 OpenClaw 整体状态（正常/异常）
- 如果一切正常，一屏内就能确认，不需要翻页或点击
- 能看到关键指标：Gateway 在线状态、Agent 运行数、最近定时任务执行情况

**成功标准**: 用户在 5 秒内完成巡检并放心关掉页面。

---

#### A2. 系统崩溃 — "救火"

**频率**: 每周 1-2 次（系统不稳定阶段）

**故事**: 收到告警或自己发现系统没响应，需要尽快恢复。

**用户期望**:
- 能明确看到哪个组件出了问题（Gateway 挂了？某个 Agent 崩了？）
- 能一键重启 Gateway 服务
- 重启后能确认服务是否恢复正常
- 如果一键重启解决不了，能看到错误日志来辅助诊断

**成功标准**: 从发现问题到服务恢复，手机操作不超过 1 分钟。

---

#### A3. 查看任务执行 — "对账"

**频率**: 每天 1 次

**故事**: 配了一些定时任务（最佳实践收集、健康检查等），想看看今天有没有正常跑完。

**用户期望**:
- 看到所有定时任务的列表
- 每个任务能看到：最近一次执行状态（成功/失败）、执行时间
- 失败的任务能看到失败原因或错误日志
- 能看到下次执行时间

**成功标准**: 30 秒内确认所有任务执行情况。

---

#### A4. 修改配置 — "调参"

**频率**: 每周数次

**故事**: 需要调整 Agent 的参数、修改 Cron 任务的执行频率、更新某些配置项。

**用户期望**:
- 能查看当前生效的关键配置
- 能在手机上直接修改常用配置项
- 修改后能立即生效或提示需要重启
- 有配置变更的记录，出问题时能回溯

**成功标准**: 能完成简单的配置变更，不需要远程桌面。

---

#### A5. 查看 Agent 状态 — "点兵"

**频率**: 每天 1-2 次

**故事**: 想看看自己配置的各个 Agent 都在不在线，有没有出错。

**用户期望**:
- 看到所有 Agent 的列表和在线/离线状态
- 离线的 Agent 能看到原因
- 能对单个 Agent 进行重启操作

**成功标准**: 快速确认所有 Agent 的健康状态。

---

### 场景域 B：开发工作监控

#### B1. 查看开发服务 — "瞧瞧"

**频率**: 开发期间每天数次

**故事**: 用 Claude Code 开发了一个项目，起了一个本地服务（比如前端 dev server），想在手机上看看效果或确认服务还在跑。

**用户期望**:
- 能看到当前正在运行的开发服务列表
- 每个服务能看到：名称、端口、运行状态、启动时间
- 能直接在手机浏览器中打开服务页面（通过穿透地址）

**成功标准**: 知道自己有哪些服务在跑，能在手机上直接访问。

---

#### B2. 管理开发服务 — "开关"

**频率**: 偶尔

**故事**: 某个开发服务不需要了想关掉，或者服务挂了想重启。

**用户期望**:
- 能启动/停止/重启开发服务
- 操作前有确认，防止误操作
- 能看到服务的运行日志（最近几十行）

**成功标准**: 不用开电脑就能管理开发服务的生命周期。

---

#### B3. 快速分享 — "给你看看"

**频率**: 偶尔

**故事**: 开发中的页面想给别人看看，需要一个可访问的链接。

**用户期望**:
- 能快速获取某个开发服务的公网访问地址
- 一键复制链接

**成功标准**: 10 秒内拿到可分享的链接。

---

## 四、功能需求

### 模块总览

基于用户场景，产品功能分为两大模块：

```
Ergo 控制台
├── 模块一：OpenClaw 运维中心
│   ├── 系统总览          (A1 瞄一眼)
│   ├── Gateway 管控       (A2 救火)
│   ├── 定时任务监控       (A3 对账)
│   ├── Agent 状态         (A5 点兵)
│   └── 配置管理          (A4 调参)
│
├── 模块二：开发服务管理
│   ├── 服务列表与状态     (B1 瞧瞧)
│   ├── 服务生命周期管理   (B2 开关)
│   └── 快速分享          (B3 给你看看)
│
└── 未来扩展区（预留）
```

---

### 模块一：OpenClaw 运维中心

#### 1.1 系统总览

**对应场景**: A1 日常巡检

**需求描述**:

页面打开后，首屏展示 OpenClaw 系统的整体健康状态。用户不需要任何操作就能看到以下信息：

- **整体状态指示**: 一个醒目的状态标识——"系统正常"（绿色）或"需要关注"（红色/黄色）
- **关键指标卡片**:
  - Gateway 运行状态 + 运行时长
  - 在线 Agent 数量 / 总数
  - 定时任务最近执行状态（成功数/失败数）
  - 网络穿透状态
- **自动刷新**: 状态数据定期刷新，无需手动操作
- **异常突出**: 有异常的指标自动变为红色/黄色高亮，正常的不干扰注意力

**信息层级**:
```
第一层（一眼可见）: 整体正常/异常
第二层（稍微看看）: 4 个指标卡片的关键数字
第三层（点击深入）: 每个指标的详细信息
```

---

#### 1.2 Gateway 管控

**对应场景**: A2 系统崩溃

**需求描述**:

提供 Gateway 的监控和操作能力，这是系统故障恢复的核心功能。

**监控能力**:
- Gateway 当前状态（运行中/已停止/启动中）
- 运行时长（上次启动以来的时间）
- 端口和访问地址
- 最近的运行日志（帮助诊断问题）

**操作能力**:
- **重启 Gateway**: 一键重启，解决大部分崩溃问题
  - 操作前需要二次确认（"确定要重启 Gateway 吗？这会中断所有正在执行的任务"）
  - 操作过程中显示进度（重启中...）
  - 操作完成后自动刷新状态确认恢复
- **查看日志**: 展示最近的运行日志，帮助定位问题
  - 最近 100 行日志
  - 支持滚动查看
  - 错误日志高亮显示

**异常处理**:
- 如果 Gateway 完全无响应（连重启命令都发不出去），页面应明确告知用户"无法连接到系统，可能需要物理访问机器"
- 给出备用建议（如：尝试通过其他方式重启）

---

#### 1.3 定时任务监控

**对应场景**: A3 查看任务执行

**需求描述**:

展示所有 Cron 定时任务的配置和执行情况。

**任务列表**:
- 任务名称
- 执行频率（人类可读，如"每 4 小时"而非 cron 表达式）
- 启用/禁用状态
- 最近一次执行：状态 + 执行时间 + 耗时
- 下次执行时间

**任务详情**（点击单个任务展开）:
- 最近 5-10 次执行记录
- 每次记录：执行时间、状态（成功/失败/运行中）、耗时
- 失败时的错误摘要

**操作能力**:
- 手动触发执行某个任务
- 启用/禁用某个任务

---

#### 1.4 Agent 状态

**对应场景**: A5 查看 Agent

**需求描述**:

展示所有配置的 Agent 列表和运行状态。

**Agent 列表**:
- Agent 名称
- 类型/角色描述
- 状态（在线/离线/错误）
- 最近活动时间

**Agent 详情**（点击展开）:
- 基本配置信息
- 运行统计（已处理消息数等）
- 最近错误信息（如有）

**操作能力**:
- 重启单个 Agent
- 启用/禁用单个 Agent

---

#### 1.5 配置管理

**对应场景**: A4 修改配置

**需求描述**:

提供常用配置的查看和修改能力。

**可查看的配置**:
- Gateway 核心配置（端口、超时设置等）
- Agent 配置列表
- Cron 任务配置
- 系统环境变量

**可修改的配置**（优先支持高频修改项）:
- Cron 任务的执行频率
- Agent 的启用/禁用
- 简单的参数调整

**安全约束**:
- 修改操作需要二次确认
- 保留最近的修改记录（谁改了什么，什么时候改的）
- 关键配置修改后提示是否需要重启服务生效

---

### 模块二：开发服务管理

#### 2.1 服务列表与状态

**对应场景**: B1 查看开发服务

**需求描述**:

展示当前机器上运行的开发服务。

**服务列表**:
- 服务/项目名称
- 运行端口
- 状态（运行中/已停止）
- 启动时间和运行时长
- 访问地址（本地 + 穿透公网地址）

**快速访问**:
- 每个服务旁有"打开"按钮，直接在新标签页访问
- 公网地址支持一键复制

---

#### 2.2 服务生命周期管理

**对应场景**: B2 管理开发服务

**需求描述**:

- 启动/停止/重启开发服务
- 查看服务运行日志（最近 50-100 行）
- 操作前二次确认

---

#### 2.3 快速分享

**对应场景**: B3 分享给别人

**需求描述**:

- 为某个开发服务快速生成公网访问链接
- 一键复制链接
- 链接旁显示穿透状态（是否可达）

---

## 五、信息架构

### 页面结构

```
┌──────────────────────────────────────────────┐
│  Header: Logo · Ergo    [系统状态指示灯: ●]  │ ← 固定顶栏
├──────────────────────────────────────────────┤
│                                              │
│  系统总览区                                   │ ← 首屏核心，不需要操作
│  ┌─────────┐ ┌─────────┐                    │
│  │ Gateway │ │ Agents  │                    │
│  │ ● 运行中│ │ 3/3 在线│                    │
│  │ 2天14时 │ │         │                    │
│  ├─────────┤ ├─────────┤                    │
│  │  Cron   │ │  穿透   │                    │
│  │ 5成功0失│ │ ● 已连接│                    │
│  │ 败      │ │         │                    │
│  └─────────┘ └─────────┘                    │
│                                              │
├──────────────────────────────────────────────┤
│                                              │
│  OpenClaw 运维                 ← 分区标题     │
│  ┌──────────────────────────────────────┐    │
│  │ Gateway 管控                    →    │    │
│  │ 运行状态 · 重启 · 日志              │    │
│  ├──────────────────────────────────────┤    │
│  │ 定时任务                        →    │    │
│  │ 5 个任务 · 最近全部成功              │    │
│  ├──────────────────────────────────────┤    │
│  │ Agent 管理                      →    │    │
│  │ 3 个在线 · 0 个异常                 │    │
│  ├──────────────────────────────────────┤    │
│  │ 配置管理                        →    │    │
│  │ 查看和修改系统配置                   │    │
│  └──────────────────────────────────────┘    │
│                                              │
│  开发服务                      ← 分区标题     │
│  ┌──────────────────────────────────────┐    │
│  │ my-dashboard     :3000  运行中  →    │    │
│  │ api-server        :8080  运行中  →    │    │
│  │                                      │    │
│  │ + 暂无更多服务                       │    │
│  └──────────────────────────────────────┘    │
│                                              │
├──────────────────────────────────────────────┤
│  Footer                                      │
└──────────────────────────────────────────────┘
```

### 导航模式

**不使用多页面或 Tab 切换**。所有内容在一个长页面中，通过分区标题和卡片组织。

理由：
- 手机端自然滚动比 Tab 切换更符合直觉
- 内容量不大，一屏半即可展示全部入口
- 避免隐藏功能在"其他 Tab"中，确保所有能力可发现

**展开/收起模式**: 每个功能卡片点击后原地展开详情面板，再次点击收起。同一时间只展开一个。

---

## 六、体验设计要求

### 手机端体验

- **单手操作**: 所有主要操作可用右手拇指触达
- **触控友好**: 可点击区域不小于 44x44px
- **快速扫描**: 关键信息（状态、数字）用大字号，辅助信息用小字号
- **无横向滚动**: 所有内容适配手机竖屏宽度

### 状态反馈

- **即时反馈**: 每个操作都有即时的视觉响应（按下变色、加载旋转等）
- **过程反馈**: 耗时操作（如重启）有明确的进度指示
- **结果反馈**: 操作完成后明确告知成功或失败
- **自动刷新**: 状态数据定期更新，不需要手动刷新页面

### 异常处理

- 网络断开：明确告知"无法连接到系统"，而非空白或假数据
- 部分服务异常：异常项高亮，正常项不受影响
- 操作失败：告知失败原因，给出可能的解决建议

### 信息密度

- **首屏**: 只展示状态概要数字，不展示详情
- **二级**: 点击展开后展示详细信息和操作按钮
- **三级**: 日志、历史记录等大量文本在独立面板中展示

---

## 七、扩展性要求

### 模块化架构

产品需要具备扩展能力，支持未来快速新增功能模块：

**当前两个模块**:
- OpenClaw 运维中心
- 开发服务管理

**可预见的未来模块**:
- Agent 对话（直接在 Ergo 中与 OpenClaw Agent 对话）
- 系统通知（服务异常时推送通知到手机）
- 文件管理（远程浏览和编辑工作空间文件）
- 系统资源监控（CPU、内存、磁盘使用率）
- 更多开发工具集成

**扩展要求**:
- 新增模块应该像"往页面上加一个新的分区卡片"一样简单
- 每个模块自包含，不影响其他模块的功能
- 页面布局能自然容纳新模块，无需大幅重构

### 迭代节奏

产品采用小步快跑的方式迭代：
- 每个迭代聚焦 1-2 个功能点
- 先做能用，再做好用
- 功能上线后根据实际使用反馈调整

---

## 八、优先级与迭代计划

### P0 — 立即要做（解决最痛的问题）

| 功能 | 对应场景 | 用户价值 |
|------|----------|----------|
| 系统总览 | A1 瞄一眼 | 不用远程桌面就能看到系统状态 |
| Gateway 重启 | A2 救火 | 系统挂了能远程恢复，省去跑回家的时间 |
| OpenClaw Dashboard 跳转 | A2 辅助 | 需要复杂操作时快速跳转 |

### P1 — 尽快做（提升日常效率）

| 功能 | 对应场景 | 用户价值 |
|------|----------|----------|
| 定时任务监控 | A3 对账 | 确认自动化流程正常运转 |
| Agent 状态查看 | A5 点兵 | 掌握 Agent 健康状况 |
| 开发服务列表与访问 | B1 瞧瞧 | 手机上直接访问开发中的服务 |

### P2 — 后续做（完善管理能力）

| 功能 | 对应场景 | 用户价值 |
|------|----------|----------|
| 配置管理 | A4 调参 | 简单修改不用远程桌面 |
| 服务生命周期管理 | B2 开关 | 远程管理开发服务 |
| 运行日志查看 | A2/A3 | 远程诊断问题 |

### P3 — 未来做（扩展能力）

- Agent 对话入口
- 系统异常通知推送
- 文件管理
- 系统资源监控

---

## 九、设计规范

### 设计风格

- **视觉基调**: Apple Design 风格，简洁、克制、专业
- **语言**: 中文界面（zh-CN）
- **主题**: 支持浅色/深色双主题，跟随系统设置自动切换，也支持手动切换
- **设计理念**: 面向 AI 时代的交互体验——简洁但不简陋，留有未来交互升级的空间

### 双主题色彩

| 色彩角色 | 浅色主题 | 深色主题 |
|----------|----------|----------|
| 品牌色 | `#007AFF` | `#0A84FF` |
| 背景-主 | `#F2F2F7` | `#000000` |
| 背景-卡片 | `#FFFFFF` | `#1C1C1E` |
| 背景-分组 | `#FFFFFF` | `#2C2C2E` |
| 文字-主 | `#000000` | `#FFFFFF` |
| 文字-次 | `#8E8E93` | `#8E8E93` |
| 分隔线 | `#C6C6C8` | `#38383A` |
| 状态-正常 | `#34C759` | `#30D158` |
| 状态-异常 | `#FF3B30` | `#FF453A` |
| 状态-警告 | `#FF9500` | `#FF9F0A` |

> 色彩取自 Apple Human Interface Guidelines 系统色板，确保在 iOS/macOS 上的原生感。

### 排版与间距

- **圆角**: 卡片 16px，按钮 12px，指标卡片 12px
- **间距**: 基于 8px 网格系统
- **字体**: SF Pro / system-ui，中文回退到苹方/思源黑体
- **手机优先**: 基准设计宽度 375px（iPhone SE），桌面端自适应拉伸

### 跨平台适配

- **手机端**（< 768px）: 主要使用场景，单列布局，大触控区域
- **桌面端**（>= 768px）: 辅助使用场景，可利用更宽空间展示更多信息
- 所有可交互元素最小触控区域 44x44pt（Apple HIG 标准）
