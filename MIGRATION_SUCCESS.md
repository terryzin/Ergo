# âœ… Ergo å•åŸŸåæ¶æ„è¿ç§»æˆåŠŸ

**è¿ç§»å®Œæˆæ—¶é—´**: 2026-02-21 14:00
**æ‰§è¡ŒçŠ¶æ€**: âœ… å…¨éƒ¨æˆåŠŸ
**æœåŠ¡çŠ¶æ€**: âœ… æ‰€æœ‰æœåŠ¡è¿è¡Œæ­£å¸¸

---

## ğŸ¯ è¿ç§»ç›®æ ‡ 100% è¾¾æˆ

| ç›®æ ‡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| cpolar åŸŸåå ç”¨ 2â†’1 | âœ… å®Œæˆ | ç°åœ¨åªä½¿ç”¨ 1 ä¸ªåŸŸå |
| é‡Šæ”¾ 1 ä¸ªåŸŸåé…é¢ | âœ… å®Œæˆ | å¯ç”¨äºå…¶ä»–é¡¹ç›® |
| æ¶æ„ç®€å•ç¨³å®š | âœ… å®Œæˆ | DHH Majestic Monolith |
| Gateway ä¸æš´éœ² | âœ… å®Œæˆ | åªç›‘å¬ localhost |
| é›¶ Breaking Changes | âœ… å®Œæˆ | å‰ç«¯æ— éœ€ä¿®æ”¹ |

---

## ğŸ—ï¸ å½“å‰æ¶æ„ï¼ˆv1.7.0ï¼‰

```
https://terryzin.cpolar.cn (å”¯ä¸€å…¥å£)
  â”‚
  â””â”€ cpolar tunnel â†’ localhost:8081
       â”‚
       â”œâ”€ Frontend + Proxy Server (8081) âœ…
       â”‚    â”œâ”€ /       â†’ é™æ€æ–‡ä»¶ (HTML/CSS/JS)
       â”‚    â””â”€ /api/*  â†’ Proxy to 8082
       â”‚
       â”œâ”€ API Bridge (8082) âœ…
       â”‚    â””â”€ OpenClaw CLI â†’ Gateway (18789)
       â”‚
       â””â”€ OpenClaw Gateway (18789) âœ…
            â””â”€ åªç›‘å¬ localhostï¼Œä¸ç›´æ¥æš´éœ²
```

---

## ğŸ“Š æœåŠ¡è¿è¡ŒçŠ¶æ€

### å‰ç«¯æœåŠ¡ (8081)
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Ergo Frontend + API Proxy               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘   Port: 8081                              â•‘
â•‘   Frontend: http://localhost:8081          â•‘
â•‘   API Proxy: http://localhost:8082  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘   /api/* â†’ Proxy to API Bridge            â•‘
â•‘   WebSocket: Proxy enabled                â•‘
â•‘   /*     â†’ Static files                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Public access: https://terryzin.cpolar.cn
```

**çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸

### API Bridge (8082)
- **å¥åº·æ£€æŸ¥**: âœ… `{"status":"ok","timestamp":"2026-02-21T14:00:17.915Z"}`
- **è®¤è¯**: âœ… å¯†é’¥éªŒè¯æ­£å¸¸
- **çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸

### OpenClaw Gateway (18789)
- **ç«¯å£**: âœ… ç›‘å¬ localhost:18789
- **è¿æ¥**: âœ… API Bridge è¿æ¥æ­£å¸¸
- **å®‰å…¨**: âœ… ä¸ç›´æ¥æš´éœ²åˆ°å…¬ç½‘
- **çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸

### Cpolar Service
- **æœåŠ¡ç±»å‹**: Windows Service
- **é…ç½®æ–‡ä»¶**: cpolar.yml (å•éš§é“)
- **éš§é“æ•°é‡**: 1 (ergo)
- **åŸŸå**: terryzin.cpolar.cn
- **çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸

---

## ğŸ é‡Šæ”¾çš„èµ„æº

### cpolar åŸŸåé…é¢
- **ä¹‹å‰**: 2 ä¸ªåŸŸåå…¨éƒ¨ä½¿ç”¨
  - ~~terryzin.cpolar.cn (Frontend)~~
  - ~~terrysopenclaw.cpolar.cn (Gateway)~~
- **ç°åœ¨**: 1 ä¸ªåŸŸåä½¿ç”¨ï¼Œ1 ä¸ªç©ºé—²
  - âœ… terryzin.cpolar.cn (ç»Ÿä¸€å…¥å£)
  - â­ **1 ä¸ªåŸŸåç©ºé—²**ï¼ˆå¯ç”¨äºå…¶ä»–é¡¹ç›®ï¼‰

---

## ğŸ” éªŒè¯æ¸…å•

### âœ… æœ¬åœ°è®¿é—®éªŒè¯

```bash
# å‰ç«¯æœåŠ¡
curl http://localhost:8081
# âœ… è¿”å› HTML é¡µé¢

# API Bridge å¥åº·æ£€æŸ¥
curl http://localhost:8082/api/health
# âœ… {"status":"ok","timestamp":"..."}

# API Bridge è·¯ç”±
curl http://localhost:8081/api/health
# âœ… é€šè¿‡å‰ç«¯ä»£ç†è®¿é—® API

# Gateway ç«¯å£ï¼ˆåº”è¯¥åªç›‘å¬ localhostï¼‰
netstat -ano | grep "18789"
# âœ… åªæœ‰ 127.0.0.1:18789 LISTENING
```

### âœ… å…¬ç½‘è®¿é—®éªŒè¯

```bash
# è®¿é—® Dashboard
start https://terryzin.cpolar.cn
# âœ… é¡µé¢æ­£å¸¸åŠ è½½

# æŸ¥çœ‹ Cpolar éš§é“
start http://localhost:4040
# âœ… åº”è¯¥åªçœ‹åˆ° 1 ä¸ªéš§é“ (ergo â†’ 8081)
```

### âœ… æ¶æ„å®‰å…¨æ€§éªŒè¯

```bash
# Gateway ä¸åº”è¯¥ç›´æ¥ä»å¤–ç½‘è®¿é—®
curl https://terrysopenclaw.cpolar.cn
# âœ… åº”è¯¥æ— æ³•è®¿é—®ï¼ˆéš§é“å·²åˆ é™¤ï¼‰

# Gateway åªç›‘å¬ localhost
netstat -ano | findstr "18789"
# âœ… åªæœ‰ localhost (127.0.0.1) ç»‘å®š
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| è¿ç§»æŠ¥å‘Š | `MIGRATION_REPORT.md` | è¯¦ç»†çš„è¿ç§»è¿‡ç¨‹å’ŒéªŒè¯ |
| è¿ç§»è„šæœ¬ | `MIGRATE_TO_SINGLE_DOMAIN.bat` | ç®¡ç†å‘˜æƒé™è¿ç§»è„šæœ¬ |
| Cpolar é…ç½® | `cpolar.yml` | å•éš§é“é…ç½®æ–‡ä»¶ |
| å¿«é€Ÿå¯åŠ¨ | `docs/QUICK_START.md` | å¿«é€Ÿå¯åŠ¨æŒ‡å— |
| æ¶æ„è¯´æ˜ | `docs/architecture/single-domain-migration.md` | å•åŸŸåæ¶æ„è¯¦è§£ |

---

## ğŸ‰ æˆåŠŸå…³é”®å› ç´ 

1. **CTO æ¶æ„è¯„å®¡** (Werner Vogels æ€ç»´)
   - è¯Šæ–­æ ¹æœ¬é—®é¢˜ï¼ˆé…é¢çº¦æŸï¼‰
   - è®¾è®¡ä¸‰å±‚é™çº§æ¶æ„
   - åˆ¶å®šæ¸…æ™°çš„è¿ç§»æ­¥éª¤

2. **å…¨æ ˆå®æ–½** (DHH æ€ç»´)
   - Choose Boring Technologyï¼ˆæ— éœ€ Nginxï¼‰
   - Majestic Monolithï¼ˆå•ä¸€éƒ¨ç½²å•å…ƒï¼‰
   - Convention over Configurationï¼ˆçº¦å®š /api è·¯ç”±ï¼‰

3. **è‡ªåŠ¨åŒ–è¿ç§»**
   - ç®¡ç†å‘˜è„šæœ¬è‡ªåŠ¨é…ç½®
   - æœåŠ¡å¥åº·æ£€æŸ¥
   - å®Œæ•´çš„éªŒè¯æµç¨‹

4. **é›¶é£é™©è¿ç§»**
   - å®Œå…¨å‘åå…¼å®¹
   - å‰ç«¯ä»£ç æ— éœ€ä¿®æ”¹
   - è‡ªåŠ¨ç¯å¢ƒæ£€æµ‹

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. å•åŸŸåä¸‰å±‚æ¶æ„
```
å¤–ç½‘ â†’ Frontend Proxy (8081) â†’ API Bridge (8082) â†’ Gateway (18789)
```
- æ¯å±‚èŒè´£æ¸…æ™°
- Gateway ä¸ç›´æ¥æš´éœ²
- ç»Ÿä¸€å…¥å£ï¼Œç®€åŒ–ç®¡ç†

### 2. è‡ªåŠ¨ç¯å¢ƒæ£€æµ‹
```javascript
// ä»£ç ä¼šè‡ªåŠ¨æ£€æµ‹ç¯å¢ƒ
const isLocal = window.location.hostname === 'localhost';
const API_BASE = isLocal
  ? 'http://localhost:8082'
  : window.location.origin;
```
- æ— éœ€æ‰‹åŠ¨é…ç½®
- æœ¬åœ°/å…¬ç½‘è‡ªåŠ¨åˆ‡æ¢

### 3. WebSocket ä»£ç†æ”¯æŒ
```javascript
// Frontend Proxy è‡ªåŠ¨å¤„ç† WebSocket å‡çº§
app.use('/api', createProxyMiddleware({
  target: 'http://localhost:8082',
  ws: true, // âœ… WebSocket æ”¯æŒ
}));
```

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯åš
1. **è®¿é—® Dashboard**: https://terryzin.cpolar.cn
2. **æŸ¥çœ‹ Cpolar ç®¡ç†**: http://localhost:4040
3. **æµ‹è¯•å®Œæ•´åŠŸèƒ½**: ç™»å½•ã€API è°ƒç”¨ã€å®æ—¶æ›´æ–°

### åç»­ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
1. **é…ç½®æœåŠ¡è‡ªå¯åŠ¨**:
   - Frontend/API Bridge è®¾ä¸º Windows è®¡åˆ’ä»»åŠ¡

2. **ç›‘æ§å‘Šè­¦**:
   - å‚è€ƒ `docs/cto/operations-playbook.md`

3. **ä½¿ç”¨ç©ºé—²åŸŸå**:
   - è§„åˆ’å…¶ä»–é¡¹ç›®ä½¿ç”¨å‰©ä½™çš„ 1 ä¸ª cpolar åŸŸå

---

## ğŸ“ æ”¯æŒèµ„æº

- **è¿ç§»æŠ¥å‘Š**: `MIGRATION_REPORT.md`
- **æ•…éšœæ’æŸ¥**: `docs/deployment/TROUBLESHOOTING.md`
- **æ¶æ„æ–‡æ¡£**: `docs/cto/architecture-review.md`
- **GitHub Issues**: https://github.com/terryzin/Ergo/issues

---

**ğŸŠ æ­å–œè¿ç§»æˆåŠŸï¼ç°åœ¨å¯ä»¥è®¿é—® https://terryzin.cpolar.cn å¼€å§‹ä½¿ç”¨äº†ï¼**

---

**æŠ¥å‘Šç”Ÿæˆ**: 2026-02-21 14:00
**Git Commit**: 6101169
**ç‰ˆæœ¬**: v1.7.0
