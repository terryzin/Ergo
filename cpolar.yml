# Cpolar 配置文件
# 标准化 Ergo 的内网穿透配置
#
# 使用方法：
# 1. 将此文件放到 cpolar 配置目录（通常是 ~/.cpolar/cpolar.yml）
# 2. 或使用 cpolar config add 命令添加隧道
# 3. 运行 cpolar start-all 启动所有隧道
#
# 注意：
# - subdomain 参数仅在 cpolar Pro 版可用
# - 免费版会分配随机域名，需要在 Web 管理界面查看

# ============================
# 隧道定义（单域名架构）
# ============================
tunnels:
  # Ergo 统一入口（静态文件 + API 代理）
  # 架构：前端(8081) → API Bridge(8082) → OpenClaw Gateway(18789)
  ergo:
    proto: http
    addr: 8081
    subdomain: terryzin  # Pro 版可指定子域名
    # region: cn         # 区域：cn/us/eu/ap
    inspect: false       # 是否启用流量监控

# ============================
# 全局配置
# ============================
# Web 管理界面端口
web_addr: 127.0.0.1:4040

# 认证 Token（从 cpolar 官网获取）
# authtoken: YOUR_AUTHTOKEN_HERE

# 日志级别 (debug/info/warn/error)
log_level: info

# 日志文件路径
# log: /var/log/cpolar.log

# ============================
# 使用示例（单域名架构）
# ============================
# 启动隧道:
#   cpolar start ergo
#
# 查看隧道状态:
#   访问 http://localhost:4040
#
# 安装为 Windows 服务:
#   cpolar service install -config cpolar.yml
#   cpolar service start
#
# ============================
# 架构说明
# ============================
# 单域名三层架构（DHH Majestic Monolith 风格）：
#   terryzin.cpolar.top (外网)
#      ↓
#   localhost:8081 (Frontend Proxy - 路由层)
#      ├─ /           → 静态文件 (HTML/CSS/JS)
#      └─ /api/*      → Proxy to localhost:8082
#           ↓
#   localhost:8082 (API Bridge - 业务层)
#      └─ OpenClaw CLI → localhost:18789 (Gateway)
#
# 优势：
# - ✅ 单域名，节约 cpolar 配额
# - ✅ 统一入口，简化访问
# - ✅ 内部服务（18789）不暴露，更安全
# - ✅ 遵循 DHH 的 Majestic Monolith 原则
